import{e as te,u as ne,a as oe,c as se,b as ie,i as ae,E as ce,B as ue,d as le}from"./events-776716bd.esm-CpH0TVUg.js";import{t as Me,r as Be,f as Fe,g as Te,h as Ie,j as ke,k as We,l as Ae,m as De,n as Ge,o as Ne,p as Xe,q as Ye,s as qe,v as Ve,w as Je,x as Ke,y as Qe,z as Ue,A as Ze,C as $e,D as er,F as rr,G as tr,H as nr}from"./events-776716bd.esm-CpH0TVUg.js";import{r as o,j as d}from"./index-DGvUaqb8.js";import{T as de}from"./three.module-Ct5vMUww.js";function A(e,r){let t;return(...s)=>{window.clearTimeout(t),t=window.setTimeout(()=>e(...s),r)}}function fe({debounce:e,scroll:r,polyfill:t,offsetSize:s}={debounce:0,scroll:!1,offsetSize:!1}){const i=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[c,u]=o.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),n=o.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:c,orientationHandler:null}),p=e?typeof e=="number"?e:e.scroll:null,m=e?typeof e=="number"?e:e.resize:null,w=o.useRef(!1);o.useEffect(()=>(w.current=!0,()=>void(w.current=!1)));const[R,y,f]=o.useMemo(()=>{const a=()=>{if(!n.current.element)return;const{left:O,top:j,width:P,height:x,bottom:L,right:H,x:S,y:M}=n.current.element.getBoundingClientRect(),l={left:O,top:j,width:P,height:x,bottom:L,right:H,x:S,y:M};n.current.element instanceof HTMLElement&&s&&(l.height=n.current.element.offsetHeight,l.width=n.current.element.offsetWidth),Object.freeze(l),w.current&&!me(n.current.lastBounds,l)&&u(n.current.lastBounds=l)};return[a,m?A(a,m):a,p?A(a,p):a]},[u,s,p,m]);function b(){n.current.scrollContainers&&(n.current.scrollContainers.forEach(a=>a.removeEventListener("scroll",f,!0)),n.current.scrollContainers=null),n.current.resizeObserver&&(n.current.resizeObserver.disconnect(),n.current.resizeObserver=null),n.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",n.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",n.current.orientationHandler))}function g(){n.current.element&&(n.current.resizeObserver=new i(f),n.current.resizeObserver.observe(n.current.element),r&&n.current.scrollContainers&&n.current.scrollContainers.forEach(a=>a.addEventListener("scroll",f,{capture:!0,passive:!0})),n.current.orientationHandler=()=>{f()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",n.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",n.current.orientationHandler))}const z=a=>{!a||a===n.current.element||(b(),n.current.element=a,n.current.scrollContainers=V(a),g())};return ve(f,!!r),pe(y),o.useEffect(()=>{b(),g()},[r,f,y]),o.useEffect(()=>b,[]),[z,c,R]}function pe(e){o.useEffect(()=>{const r=e;return window.addEventListener("resize",r),()=>void window.removeEventListener("resize",r)},[e])}function ve(e,r){o.useEffect(()=>{if(r){const t=e;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[e,r])}function V(e){const r=[];if(!e||e===document.body)return r;const{overflow:t,overflowX:s,overflowY:i}=window.getComputedStyle(e);return[t,s,i].some(c=>c==="auto"||c==="scroll")&&r.push(e),[...r,...V(e.parentElement)]}const he=["x","y","top","bottom","left","right","width","height"],me=(e,r)=>he.every(t=>e[t]===r[t]);var we=Object.defineProperty,be=Object.defineProperties,Ee=Object.getOwnPropertyDescriptors,D=Object.getOwnPropertySymbols,ye=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable,G=(e,r,t)=>r in e?we(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,N=(e,r)=>{for(var t in r||(r={}))ye.call(r,t)&&G(e,t,r[t]);if(D)for(var t of D(r))ge.call(r,t)&&G(e,t,r[t]);return e},xe=(e,r)=>be(e,Ee(r)),X,Y;typeof window<"u"&&((X=window.document)!=null&&X.createElement||((Y=window.navigator)==null?void 0:Y.product)==="ReactNative")?o.useLayoutEffect:o.useEffect;function J(e,r,t){if(!e)return;if(t(e)===!0)return e;let s=e.child;for(;s;){const i=J(s,r,t);if(i)return i;s=s.sibling}}function K(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const q=console.error;console.error=function(){const e=[...arguments].join("");if(e?.startsWith("Warning:")&&e.includes("useContext")){console.error=q;return}return q.apply(this,arguments)};const B=K(o.createContext(null));class Q extends o.Component{render(){return o.createElement(B.Provider,{value:this._reactInternals},this.props.children)}}function Ce(){const e=o.useContext(B);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const r=o.useId();return o.useMemo(()=>{for(const s of[e,e?.alternate]){if(!s)continue;const i=J(s,!1,c=>{let u=c.memoizedState;for(;u;){if(u.memoizedState===r)return!0;u=u.next}});if(i)return i}},[e,r])}function _e(){const e=Ce(),[r]=o.useState(()=>new Map);r.clear();let t=e;for(;t;){if(t.type&&typeof t.type=="object"){const i=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;i&&i!==B&&!r.has(i)&&r.set(i,o.useContext(K(i)))}t=t.return}return r}function Re(){const e=_e();return o.useMemo(()=>Array.from(e.keys()).reduce((r,t)=>s=>o.createElement(r,null,o.createElement(t.Provider,xe(N({},s),{value:e.get(t)}))),r=>o.createElement(Q,N({},r))),[e])}const ze=o.forwardRef(function({children:r,fallback:t,resize:s,style:i,gl:c,events:u=ie,eventSource:n,eventPrefix:p,shadows:m,linear:w,flat:R,legacy:y,orthographic:f,frameloop:b,dpr:g,performance:z,raycaster:a,camera:O,scene:j,onPointerMissed:P,onCreated:x,...L},H){o.useMemo(()=>te(de),[]);const S=Re(),[M,l]=fe({scroll:!0,debounce:{scroll:50,resize:0},...s}),C=o.useRef(null),F=o.useRef(null);o.useImperativeHandle(H,()=>C.current);const T=ne(P),[I,U]=o.useState(!1),[k,Z]=o.useState(!1);if(I)throw I;if(k)throw k;const _=o.useRef(null);oe(()=>{const E=C.current;l.width>0&&l.height>0&&E&&(_.current||(_.current=se(E)),_.current.configure({gl:c,events:u,shadows:m,linear:w,flat:R,legacy:y,orthographic:f,frameloop:b,dpr:g,performance:z,raycaster:a,camera:O,scene:j,size:l,onPointerMissed:(...v)=>T.current==null?void 0:T.current(...v),onCreated:v=>{v.events.connect==null||v.events.connect(n?ae(n)?n.current:n:F.current),p&&v.setEvents({compute:(W,h)=>{const ee=W[p+"X"],re=W[p+"Y"];h.pointer.set(ee/h.size.width*2-1,-(re/h.size.height)*2+1),h.raycaster.setFromCamera(h.pointer,h.camera)}}),x?.(v)}}),_.current.render(d.jsx(S,{children:d.jsx(ce,{set:Z,children:d.jsx(o.Suspense,{fallback:d.jsx(ue,{set:U}),children:r??null})})})))}),o.useEffect(()=>{const E=C.current;if(E)return()=>le(E)},[]);const $=n?"none":"auto";return d.jsx("div",{ref:F,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:$,...i},...L,children:d.jsx("div",{ref:M,style:{width:"100%",height:"100%"},children:d.jsx("canvas",{ref:C,style:{display:"block"},children:t})})})}),Le=o.forwardRef(function(r,t){return d.jsx(Q,{children:d.jsx(ze,{...r,ref:t})})});export{Le as Canvas,Me as ReactThreeFiber,Be as _roots,Fe as act,Te as addAfterEffect,Ie as addEffect,ke as addTail,We as advance,Ae as applyProps,De as buildGraph,Ge as context,Ne as createEvents,ie as createPointerEvents,Xe as createPortal,se as createRoot,Ye as dispose,ie as events,te as extend,qe as flushGlobalEffects,Ve as flushSync,Je as getRootState,Ke as invalidate,Qe as reconciler,Ue as render,le as unmountComponentAtNode,Ze as useFrame,$e as useGraph,er as useInstanceHandle,rr as useLoader,tr as useStore,nr as useThree};
